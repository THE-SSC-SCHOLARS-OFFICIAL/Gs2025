
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Night-NewBie</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
  :root {
    --primary: #6a5af9; --secondary: #5041d5; --accent: #f72585;
    --bg-light: #f4f7fc; --bg-dark: #161925;
    --surface-light: #ffffff; --surface-dark: #232a40;
    --text-light: #212529; --text-dark: #e8eaed;
    --border-light: rgba(0, 0, 0, 0.1); --border-dark: rgba(255, 255, 255, 0.1);
    --glass-light: rgba(255, 255, 255, 0.7); --glass-dark: rgba(35, 42, 64, 0.7);
    --success: #20c997; --danger: #e63946; --warning: #ffb703; --info: #0096c7;
  }

  html {
      font-size: 14px; /* Reduced base font size */
  }

  * { box-sizing: border-box; }

  body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg-light);
    color: var(--text-light);
    margin: 0;
    transition: background-color 0.3s, color 0.3s;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  body.dark-mode {
    background-color: var(--bg-dark);
    color: var(--text-dark);
  }

  /* --- Home Screen --- */
  #home-screen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    height: 100vh;
    padding: 20px;
  }
  .home-header {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--primary);
    margin-bottom: 2rem;
  }
  .home-card {
    max-width: 500px;
    width: 100%;
    padding: 2rem;
  }
  .home-card h2 {
      font-size: 2rem;
      font-weight: 600;
      margin-bottom: 1.5rem;
  }
  .test-details p {
      display: flex;
      justify-content: space-between;
      font-size: 1.1rem;
      margin-bottom: 1rem;
      border-bottom: 1px solid var(--border-light);
      padding-bottom: 1rem;
  }
  body.dark-mode .test-details p {
      border-bottom-color: var(--border-dark);
  }
  .test-details p span:first-child {
      font-weight: 500;
      opacity: 0.8;
      white-space: nowrap;
      margin-right: 15px;
  }
  .test-details p span:last-child {
      font-weight: 600;
      text-align: right;
      word-break: break-word; /* Ensure long URLs wrap */
  }
  #startQuizBtn {
      width: 100%;
      padding: 12px;
      font-size: 1.2rem;
      font-weight: 600;
      background-color: var(--primary);
      color: #fff;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background-color 0.2s;
  }
   #startQuizBtn:hover {
      background-color: var(--secondary);
   }
  .home-footer {
      position: absolute;
      bottom: 0;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 20px 40px;
      font-weight: 600;
      opacity: 0.9;
  }
  /* Updated Home Footer Links */
  .home-footer a {
      color: inherit;
      text-decoration: none;
      transition: color 0.2s;
  }
  .home-footer a:hover {
      color: var(--primary);
      text-decoration: underline;
  }


  /* --- Main Layout --- */
  .quiz-layout {
    display: grid;
    grid-template-columns: 260px 1fr 280px;
    height: 100vh;
    overflow: hidden;
  }

  .quiz-sidebar, .quiz-main, .quiz-palette {
    height: 100vh;
    overflow-y: auto;
    padding: 20px;
  }
  .quiz-main {
    padding: 20px 20px 0 20px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .quiz-sidebar {
    background-color: var(--surface-light);
    border-right: 1px solid var(--border-light);
  }
  body.dark-mode .quiz-sidebar {
    background-color: var(--surface-dark);
    border-right-color: var(--border-dark);
  }

  .quiz-palette {
    background-color: var(--surface-light);
    border-left: 1px solid var(--border-light);
  }
  body.dark-mode .quiz-palette {
    background-color: var(--surface-dark);
    border-left-color: var(--border-dark);
  }

  /* --- Shared Card Style --- */
  .card-ui {
    background-color: var(--surface-light);
    border-radius: 12px;
    border: 1px solid var(--border-light);
    margin-bottom: 20px;
    padding: 18px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.04);
  }
  body.dark-mode .card-ui {
    background-color: var(--surface-dark);
    border-color: var(--border-dark);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  /* --- Left Sidebar: Timer & Info --- */
  .quiz-brand { font-size: 1.5rem; font-weight: 700; color: var(--primary); }
  .timer-box { text-align: center; }
  .timer-display { font-size: 3rem; font-weight: 700; letter-spacing: 2px; }
  #timeProgress { height: 6px; border-radius: 3px; }

  .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
  .stat-item { text-align: center; background: rgba(0,0,0,0.03); padding: 8px; border-radius: 8px; }
  body.dark-mode .stat-item { background: rgba(255,255,255,0.05); }
  .stat-item .value { font-weight: 700; font-size: 1.25rem; }
  .stat-item .label { font-size: 0.75rem; opacity: 0.7; }
  .value.correct { color: var(--success); }
  .value.incorrect { color: var(--danger); }
  .value.marked { color: var(--info); }
  .value.unattempted { color: var(--warning); }


  /* --- Main Content Area --- */
  .quiz-main-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    gap: 10px;
  }

  /* New Header Timer Style */
  .header-timer {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--primary);
      margin-left: 15px;
      margin-right: auto; /* Pushes subsequent items to the right */
      letter-spacing: 1px;
      font-variant-numeric: tabular-nums;
  }

  .mobile-menu-toggle { display: none; background: none; border: none; font-size: 1.375rem; color: var(--text-light); }
  body.dark-mode .mobile-menu-toggle { color: var(--text-dark); }

  .quiz-content-area {
      flex: 1 1 auto;
      overflow-y: auto;
      margin: 0 -20px;
      padding: 0 20px 20px 20px;
  }

  .thin-progress-bar {
    height: 4px;
    background-color: var(--border-light);
    border-radius: 2px;
    margin-bottom: 20px;
    overflow: hidden;
  }
  body.dark-mode .thin-progress-bar {
      background-color: var(--border-dark);
  }
  .thin-progress-bar-inner {
      height: 100%;
      width: 0%;
      background-color: var(--primary);
      border-radius: 2px;
      transition: width 0.3s ease-in-out;
  }

  .q-text { font-size: 1.25rem; font-weight: 500; margin: 12px 0; line-height: 1.6; }

  .option-btn {
    width: 100%; text-align: left;
    border: 1px solid var(--border-light);
    background: transparent; color: inherit;
    border-radius: 10px; padding: 14px 18px;
    margin: 8px 0; transition: .2s ease all; font-size: 1rem;
  }
  body.dark-mode .option-btn { border-color: var(--border-dark); }
  .option-btn:hover { border-color: var(--primary); background: rgba(106,90,249, 0.05); transform: translateY(-2px); }
  .option-btn.selected { background: var(--secondary); color: #fff; border-color: var(--secondary); }
  .option-btn.correct { background: var(--success) !important; color: #fff; border-color: var(--success) !important; }
  .option-btn.incorrect { background: var(--danger) !important; color: #fff; border-color: var(--danger) !important; }

  .explanation {
    background: rgba(106,90,249, 0.05);
    border-left: 4px solid var(--primary);
    border-radius: 8px; padding: 14px; margin-top: 16px;
    font-size: 0.9rem;
  }

  /* Question Timer Styling & Accuracy Badge */
  .q-meta-container {
      display: inline-flex;
      align-items: center;
      gap: 10px;
  }
  .q-timer {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--primary);
      background: rgba(106,90,249, 0.1);
      padding: 4px 8px;
      border-radius: 4px;
      display: inline-flex;
      align-items: center;
  }
  .q-accuracy {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--success);
      background: rgba(32, 201, 151, 0.1);
      padding: 4px 8px;
      border-radius: 4px;
      display: inline-flex;
      align-items: center;
  }
  body.dark-mode .q-timer { color: #9d8fff; background: rgba(106,90,249, 0.2); }
  body.dark-mode .q-accuracy { color: #4ade80; background: rgba(32, 201, 151, 0.2); }

  .quiz-nav-buttons { 
      display: flex; 
      justify-content: space-between; 
      margin: 0 -20px;
      padding: 15px 20px;
      border-top: 1px solid var(--border-light);
      background: var(--surface-light);
      transition: background-color 0.3s, border-color 0.3s;
  }
  body.dark-mode .quiz-nav-buttons {
      border-top-color: var(--border-dark);
      background: var(--surface-dark);
  }
  .btn-nav { padding: 10px 20px; border-radius: 8px; font-weight: 600; }

  /* --- Right Sidebar: Question Palette --- */
  .palette-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(45px, 1fr)); gap: 8px; }
  .q-tile {
    width: 100%; aspect-ratio: 1 / 1;
    display: flex; align-items: center; justify-content: center;
    border: 1px solid var(--border-light);
    border-radius: 8px; font-weight: 600; cursor: pointer;
    transition: .2s ease all;
  }
  body.dark-mode .q-tile { border-color: var(--border-dark); }
  .q-tile:hover { transform: scale(1.08); }
  .q-tile.current { background-color: var(--primary); color: #fff; border-color: var(--primary); }
  .q-tile.answered { background-color: var(--success); color: #fff; border-color: var(--success); }
  .q-tile.marked { box-shadow: 0 0 0 2px var(--info) inset; }
  .q-tile.review-correct { background-color: var(--success); color: #fff; border-color: transparent; }
  .q-tile.review-incorrect { background-color: var(--danger); color: #fff; border-color: transparent; }
  .q-tile.review-unattempted { background-color: var(--warning); color: #fff; border-color: transparent; }

  /* --- Results View --- */
  .results-container { text-align: center; }
  .final-score { font-size: 5rem; font-weight: 800; color: var(--primary); }
  .results-tabs .nav-link { color: inherit; opacity: 0.7; }
  .results-tabs .nav-link.active { color: var(--primary); font-weight: 600; opacity: 1; border-bottom: 2px solid var(--primary); border-radius: 0; background: none; }
  .chart-container { height: 250px; }

  /* Leaderboard Styles */
  .leaderboard-table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 0.95rem; }
  .leaderboard-table th, .leaderboard-table td { padding: 12px; text-align: left; border-bottom: 1px solid var(--border-light); }
  body.dark-mode .leaderboard-table th, body.dark-mode .leaderboard-table td { border-bottom-color: var(--border-dark); }
  .leaderboard-table th { font-weight: 600; opacity: 0.8; }
  .rank-1 { color: #FFD700; font-weight: bold; }
  .rank-2 { color: #C0C0C0; font-weight: bold; }
  .rank-3 { color: #CD7F32; font-weight: bold; }

  /* --- Header Action Buttons --- */
  .header-actions {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    flex-grow: 1;
    gap: 8px;
  }
  .action-btn {
    background: transparent;
    border: none;
    color: var(--text-light);
    width: 40px;
    height: 40px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    transition: all 0.2s ease;
  }
  .action-btn:hover {
    transform: scale(1.1);
    background-color: rgba(0,0,0,0.05);
  }
  body.dark-mode .action-btn {
    color: var(--text-dark);
  }
  body.dark-mode .action-btn:hover {
    background-color: rgba(255,255,255,0.1);
  }

  #languageSwitch button {
    font-weight: 700;
    min-width: 55px;
    padding: 0 8px;
    height: 40px;
    border-radius: 8px;
    background-color: transparent;
    border: 1px solid var(--border-light);
    color: var(--text-light);
    box-shadow: none;
    transition: all 0.2s ease;
    font-size: 0.9rem;
  }
  body.dark-mode #languageSwitch button {
    background-color: transparent;
    border-color: var(--border-dark);
    color: var(--text-dark);
  }
  #languageSwitch button:hover {
      border-color: var(--primary);
      color: var(--primary);
  }

  /* --- Responsive Design --- */
  @media (max-width: 992px) {
    .quiz-layout { grid-template-columns: 1fr; }
    .quiz-sidebar, .quiz-palette {
      position: fixed; top: 0;
      width: 280px; height: 100%;
      z-index: 1100;
      transition: transform 0.3s ease;
      box-shadow: 0 0 40px rgba(0,0,0,0.2);
    }
    .quiz-sidebar { transform: translateX(-100%); left: 0; border-right: none; }
    .quiz-palette { transform: translateX(100%); right: 0; border-left: none; }
    .quiz-sidebar.show, .quiz-palette.show { transform: translateX(0); }

    .mobile-menu-toggle { display: block; }
    .overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.5);
      z-index: 1090; opacity: 0; visibility: hidden; transition: .3s;
    }
    .overlay.show { opacity: 1; visibility: visible; }

    /* Adjust header timer on mobile */
    .header-timer { font-size: 1.1rem; margin-left: 10px; }
  }
</style>
</head>
<body>

<div id="home-screen">
    <h1 class="home-header">TEST</h1>
    <div class="card-ui home-card">
        <h2>Test</h2>
        <div class="test-details">
            <p><span>Topic</span> <span id="homeTopic">Topic Name Here</span></p>
            <p><span>Q.</span> <span id="homeQuestions">0</span></p>
            <p><span>Timer</span> <span id="homeTime">0 Minutes</span></p>
            <p><span>N.Mark</span> <span id="homeNegative">0</span></p>
        </div>
        <button id="startQuizBtn">Start</button>
    </div>
    <footer class="home-footer">
        <!-- Clickable Links -->
        <a href="https://t.me/AI_quiz_bot_pro" target="_blank">@AI_quiz_bot_pro</a>
        <a href="https://t.me/elite_quiz_bot" target="_blank">@elite_quiz_bot</a>
    </footer>
</div>


<div id="quiz-screen" style="display: none;">
    <audio id="clickSound" src="https://assets.mixkit.co/active_storage/sfx/269/269.wav" preload="auto"></audio>
    <audio id="swipeSound" src="https://assets.mixkit.co/active_storage/sfx/1897/1897.wav" preload="auto"></audio>
    <audio id="correctSound" src="https://assets.mixkit.co/active_storage/sfx/2870/2870.wav" preload="auto"></audio>
    <audio id="wrongSound" src="https://assets.mixkit.co/active_storage/sfx/2964/2964.wav" preload="auto"></audio>

    <div class="overlay" id="overlay"></div>

    <div class="quiz-layout">
      <aside class="quiz-sidebar" id="infoSidebar">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div class="quiz-brand">@elite_quiz_bot</div>
            <button class="mobile-menu-toggle" id="closeInfoSidebar"><i class="fas fa-times"></i></button>
        </div>
        <div class="card-ui timer-box">
            <div class="timer-display"><span id="minutes">00</span>:<span id="seconds">00</span></div>
            <div class="progress mt-2">
              <div id="timeProgress" class="progress-bar bg-primary" style="width:100%"></div>
            </div>
        </div>
        <div class="card-ui">
            <h5 class="fw-bold mb-3">Quiz Stats</h5>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="value correct" id="statAnswered">0</div>
                    <div class="label">Answered</div>
                </div>
                <div class="stat-item">
                    <div class="value unattempted" id="statUnanswered">0</div>
                    <div class="label">Unanswered</div>
                </div>
                <div class="stat-item">
                    <div class="value marked" id="statMarked">0</div>
                    <div class="label">Marked</div>
                </div>
                 <div class="stat-item">
                    <div class="value" id="statTotal">0</div>
                    <div class="label">Total</div>
                </div>
            </div>
        </div>
         <button id="submitBtn" class="btn btn-primary w-100 py-2 fw-bold">
            <i class="fas fa-paper-plane me-2"></i>Submit Quiz
         </button>
      </aside>

      <main class="quiz-main">
        <div class="quiz-main-header">
          <button class="mobile-menu-toggle" id="openInfoSidebar"><i class="fas fa-bars"></i></button>

          <!-- MAIN HEADER TIMER ADDED HERE -->
          <div class="header-timer" id="headerTimerDisp">00:00</div>

          <div class="header-actions">
              <div id="languageSwitch">
                  <button id="langToggleBtn">BILI</button>
              </div>
              <button class="action-btn" id="fontDecreaseBtn" aria-label="Decrease font size"><i class="fas fa-minus"></i></button>
              <button class="action-btn" id="fontIncreaseBtn" aria-label="Increase font size"><i class="fas fa-plus"></i></button>
              <button class="action-btn" id="fullscreenToggle" aria-label="Toggle fullscreen"><i class="fas fa-expand"></i></button>
              <button class="action-btn" id="themeToggle" aria-label="Toggle theme"><i class="fas fa-moon"></i></button>
          </div>

          <button class="mobile-menu-toggle" id="openPaletteSidebar"><i class="fas fa-th-large"></i></button>
        </div>

        <div class="quiz-content-area">
            <div class="thin-progress-bar">
                <div id="thinProgressBarInner" class="thin-progress-bar-inner"></div>
            </div>
            <div id="questionArea"></div>
            <div id="resultsContainer" style="display: none;"></div>
        </div>

        <div id="quizNav" class="quiz-nav-buttons" style="display: none;"></div>

      </main>

      <aside class="quiz-palette" id="paletteSidebar">
         <div class="d-flex justify-content-between align-items-center mb-4">
            <h5 class="fw-bold m-0">Question Palette</h5>
            <button class="mobile-menu-toggle" id="closePaletteSidebar"><i class="fas fa-times"></i></button>
        </div>
        <div class="palette-grid" id="qList"></div>
        <div class="mt-4">
            <h6 class="fw-bold">Legend</h6>
            <div class="d-flex align-items-center small my-2"><div class="q-tile me-2" style="width: 25px; height: 25px;"></div> Not Visited</div>
            <div class="d-flex align-items-center small my-2"><div class="q-tile answered me-2" style="width: 25px; height: 25px;"></div> Answered</div>
            <div class="d-flex align-items-center small my-2"><div class="q-tile marked me-2" style="width: 25px; height: 25px;"></div> Marked for Review</div>
            <div class="d-flex align-items-center small my-2"><div class="q-tile current me-2" style="width: 25px; height: 25px;"></div> Current Question</div>
        </div>
      </aside>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
// Placeholder quizData, will be replaced by Python
const quizData = {
  "settings": {
    "topic": "Mediaeval History \n\nBhakti and sufi Movements \n\n\ud83c\udfaf Discussion & quiz:-https://t.me/+jLBCSC40twkyNWZl \n\ud83d\udccc Quiz collection:-  https://t.me/+_sXRuzxAFGwzMWE1\n\ud83c\udfaf other than warbook quizzes link :- https://t.me/quizz_whizz/130",
    "totalTimeSec": 180,
    "negativeMarkPerWrong": 0.33
  },
  "questions": [
    {
      "text": "<b>Q1.</b> Q1. Sattriya, one of the classical dances of India, was introduced by which saint? / \u092d\u093e\u0930\u0924 \u0915\u0947 \u0936\u093e\u0938\u094d\u0924\u094d\u0930\u0940\u092f \u0928\u0943\u0924\u094d\u092f\u094b\u0902 \u092e\u0947\u0902 \u0938\u0947 \u090f\u0915, \u0938\u0924\u094d\u0930\u093f\u092f\u093e, \u0915\u093f\u0938 \u0938\u0902\u0924 \u0926\u094d\u0935\u093e\u0930\u093e \u0936\u0941\u0930\u0942 \u0915\u093f\u092f\u093e \u0917\u092f\u093e \u0925\u093e? [SSC Steno, 07/08/2025, Shift-3]",
      "options": [
        "Sankardev / \u0936\u0902\u0915\u0930\u0926\u0947\u0935",
        "Chaitanya Mahaprabhu / \u091a\u0948\u0924\u0928\u094d\u092f \u092e\u0939\u093e\u092a\u094d\u0930\u092d\u0941",
        "Kabir / \u0915\u092c\u0940\u0930",
        "Tulsidas / \u0924\u0941\u0932\u0938\u0940\u0926\u093e\u0938"
      ],
      "correctIndex": 0,
      "explanation": "Srimanta Sankardev, the great 15th-century Vaishnavite saint and social reformer of Assam, introduced the Sattriya dance form. He developed it as a medium to propagate the Bhakti movement (Ekasarana Dharma) through his plays known as 'Ankiya Nat'. It was performed in the monasteries (Sattras) established by him. It is now recognized as one of the eight major classical dance forms of India. / \u0905\u0938\u092e \u0915\u0947 \u092e\u0939\u093e\u0928 15\u0935\u0940\u0902 \u0936\u0924\u093e\u092c\u094d\u0926\u0940 \u0915\u0947 \u0935\u0948\u0937\u094d\u0923\u0935 \u0938\u0902\u0924 \u0914\u0930 \u0938\u092e\u093e\u091c \u0938\u0941\u0927\u093e\u0930\u0915 \u0936\u094d\u0930\u0940\u092e\u0902\u0924 \u0936\u0902\u0915\u0930\u0926\u0947\u0935 \u0928\u0947 \u0938\u0924\u094d\u0930\u093f\u092f\u093e \u0928\u0943\u0924\u094d\u092f \u0936\u0948\u0932\u0940 \u0915\u0940 \u0936\u0941\u0930\u0941\u0906\u0924 \u0915\u0940\u0964 \u0909\u0928\u094d\u0939\u094b\u0902\u0928\u0947 \u0907\u0938\u0947 \u0905\u092a\u0928\u0947 \u0928\u093e\u091f\u0915\u094b\u0902 \u0915\u0947 \u092e\u093e\u0927\u094d\u092f\u092e \u0938\u0947 \u092d\u0915\u094d\u0924\u093f \u0906\u0902\u0926\u094b\u0932\u0928 (\u090f\u0915\u0936\u0930\u0923 \u0927\u0930\u094d\u092e) \u0915\u0947 \u092a\u094d\u0930\u091a\u093e\u0930 \u0915\u0947 \u092e\u093e\u0927\u094d\u092f\u092e \u0915\u0947 \u0930\u0942\u092a \u092e\u0947\u0902 \u0935\u093f\u0915\u0938\u093f\u0924 \u0915\u093f\u092f\u093e, \u091c\u093f\u0928\u094d\u0939\u0947\u0902 '\u0905\u0902\u0915\u093f\u092f\u093e \u0928\u093e\u091f' \u0915\u0947 \u0930\u0942\u092a \u092e\u0947\u0902 \u091c\u093e\u0928\u093e \u091c\u093e\u0924\u093e \u0939\u0948\u0964 \u092f\u0939 \u0909\u0928\u0915\u0947 \u0926\u094d\u0935\u093e\u0930\u093e \u0938\u094d\u0925\u093e\u092a\u093f\u0924 \u092e\u0920\u094b\u0902 (\u0938\u0924\u094d\u0930\u094b\u0902) \u092e\u0947\u0902 \u092a\u094d\u0930\u0926\u0930\u094d\u0936\u093f\u0924 \u0915\u093f\u092f\u093e \u091c\u093e\u0924\u093e \u0925\u093e\u0964 \u0905\u092c \u0907\u0938\u0947 \u092d\u093e\u0930\u0924 \u0915\u0947 \u0906\u0920 \u092a\u094d\u0930\u092e\u0941\u0916 \u0936\u093e\u0938\u094d\u0924\u094d\u0930\u0940\u092f \u0928\u0943\u0924\u094d\u092f \u0930\u0942\u092a\u094b\u0902 \u092e\u0947\u0902 \u0938\u0947 \u090f\u0915 \u0915\u0947 \u0930\u0942\u092a \u092e\u0947\u0902 \u092e\u093e\u0928\u094d\u092f\u0924\u093e \u092a\u094d\u0930\u093e\u092a\u094d\u0924 \u0939\u0948\u0964",
      "reference": ""
    },
    {
      "text": "<b>Q2.</b> Q2. Which of the following statements is correct about Urs at Ajmer Sharif? / \u0905\u091c\u092e\u0947\u0930 \u0936\u0930\u0940\u092b \u0915\u0947 \u0909\u0930\u094d\u0938 \u0915\u0947 \u092c\u093e\u0930\u0947 \u092e\u0947\u0902 \u0928\u093f\u092e\u094d\u0928\u0932\u093f\u0916\u093f\u0924 \u092e\u0947\u0902 \u0938\u0947 \u0915\u094c\u0928 \u0938\u093e \u0915\u0925\u0928 \u0938\u0939\u0940 \u0939\u0948? [SSC Steno, 08/08/2025, Shift-1]",
      "options": [
        "It follows the lunar calendar and marks the saint&#x27;s death. / \u092f\u0939 \u091a\u0902\u0926\u094d\u0930 \u0915\u0948\u0932\u0947\u0902\u0921\u0930 \u0915\u093e \u092a\u093e\u0932\u0928 \u0915\u0930\u0924\u093e \u0939\u0948 \u0914\u0930 \u0938\u0902\u0924 \u0915\u0940 \u092e\u0943\u0924\u094d\u092f\u0941 \u0915\u093e \u092a\u094d\u0930\u0924\u0940\u0915 \u0939\u0948\u0964",
        "It is celebrated annually based on the solar calendar. / \u092f\u0939 \u0938\u094c\u0930 \u0915\u0948\u0932\u0947\u0902\u0921\u0930 \u0915\u0947 \u0906\u0927\u093e\u0930 \u092a\u0930 \u092a\u094d\u0930\u0924\u093f\u0935\u0930\u094d\u0937 \u092e\u0928\u093e\u092f\u093e \u091c\u093e\u0924\u093e \u0939\u0948\u0964",
        "It marks the birth anniversary of Khwaja Moinuddin Chishti. / \u092f\u0939 \u0916\u094d\u0935\u093e\u091c\u093e \u092e\u094b\u0907\u0928\u0941\u0926\u094d\u0926\u0940\u0928 \u091a\u093f\u0936\u094d\u0924\u0940 \u0915\u0940 \u091c\u092f\u0902\u0924\u0940 \u0915\u093e \u092a\u094d\u0930\u0924\u0940\u0915 \u0939\u0948\u0964",
        "It is held only once every five years during Ramzan. / \u092f\u0939 \u0930\u092e\u091c\u093e\u0928 \u0915\u0947 \u0926\u094c\u0930\u093e\u0928 \u0939\u0930 \u092a\u093e\u0902\u091a \u0938\u093e\u0932 \u092e\u0947\u0902 \u0915\u0947\u0935\u0932 \u090f\u0915 \u092c\u093e\u0930 \u0906\u092f\u094b\u091c\u093f\u0924 \u0915\u093f\u092f\u093e \u091c\u093e\u0924\u093e \u0939\u0948\u0964"
      ],
      "correctIndex": 0,
      "explanation": "The Urs festival at Ajmer Sharif follows the Islamic lunar calendar (Hijri) and marks the death anniversary (Visal) of the Sufi saint Khwaja Moinuddin Chishti. In Sufism, the saint's death is celebrated as a \"wedding\" (Urs) or union of the soul with God (the Beloved), hence it is a joyous occasion. It is held annually in the month of Rajab. It does not mark his birth. / \u0905\u091c\u092e\u0947\u0930 \u0936\u0930\u0940\u092b \u092e\u0947\u0902 \u0909\u0930\u094d\u0938 \u0909\u0924\u094d\u0938\u0935 \u0907\u0938\u094d\u0932\u093e\u092e\u0940 \u091a\u0902\u0926\u094d\u0930 \u0915\u0948\u0932\u0947\u0902\u0921\u0930 (\u0939\u093f\u091c\u0930\u0940) \u0915\u093e \u092a\u093e\u0932\u0928 \u0915\u0930\u0924\u093e \u0939\u0948 \u0914\u0930 \u0938\u0942\u092b\u0940 \u0938\u0902\u0924 \u0916\u094d\u0935\u093e\u091c\u093e \u092e\u094b\u0907\u0928\u0941\u0926\u094d\u0926\u0940\u0928 \u091a\u093f\u0936\u094d\u0924\u0940 \u0915\u0940 \u092a\u0941\u0923\u094d\u092f\u0924\u093f\u0925\u093f (\u0935\u093f\u0938\u093e\u0932) \u0915\u093e \u092a\u094d\u0930\u0924\u0940\u0915 \u0939\u0948\u0964 \u0938\u0942\u092b\u0940\u0935\u093e\u0926 \u092e\u0947\u0902, \u0938\u0902\u0924 \u0915\u0940 \u092e\u0943\u0924\u094d\u092f\u0941 \u0915\u094b \"\u0936\u093e\u0926\u0940\" (\u0909\u0930\u094d\u0938) \u092f\u093e \u0908\u0936\u094d\u0935\u0930 (\u092a\u094d\u0930\u093f\u092f\u0924\u092e) \u0915\u0947 \u0938\u093e\u0925 \u0906\u0924\u094d\u092e\u093e \u0915\u0947 \u092e\u093f\u0932\u0928 \u0915\u0947 \u0930\u0942\u092a \u092e\u0947\u0902 \u092e\u0928\u093e\u092f\u093e \u091c\u093e\u0924\u093e \u0939\u0948, \u0907\u0938\u0932\u093f\u090f \u092f\u0939 \u090f\u0915 \u0916\u0941\u0936\u0940 \u0915\u093e \u0905\u0935\u0938\u0930 \u0939\u094b\u0924\u093e \u0939\u0948\u0964 \u092f\u0939 \u092a\u094d\u0930\u0924\u093f\u0935\u0930\u094d\u0937 \u0930\u091c\u094d\u091c\u092c \u0915\u0947 \u092e\u0939\u0940\u0928\u0947 \u092e\u0947\u0902 \u0906\u092f\u094b\u091c\u093f\u0924 \u0915\u093f\u092f\u093e \u091c\u093e\u0924\u093e \u0939\u0948\u0964 \u092f\u0939 \u0909\u0928\u0915\u0947 \u091c\u0928\u094d\u092e \u0915\u093e \u092a\u094d\u0930\u0924\u0940\u0915 \u0928\u0939\u0940\u0902 \u0939\u0948\u0964",
      "reference": ""
    },
    {
      "text": "<b>Q3.</b> Q3. In Bhakti traditions, which two broad types of worship are mentioned? / \u092d\u0915\u094d\u0924\u093f \u092a\u0930\u0902\u092a\u0930\u093e\u0913\u0902 \u092e\u0947\u0902, \u092a\u0942\u091c\u093e \u0915\u0947 \u0915\u093f\u0928 \u0926\u094b \u0935\u094d\u092f\u093e\u092a\u0915 \u092a\u094d\u0930\u0915\u093e\u0930\u094b\u0902 \u0915\u093e \u0909\u0932\u094d\u0932\u0947\u0916 \u0915\u093f\u092f\u093e \u0917\u092f\u093e \u0939\u0948? [SSC CGL Tier 1, 13 Sep 2025, Shift-1]",
      "options": [
        "Vedic and Non-Vedic / \u0935\u0948\u0926\u093f\u0915 \u0914\u0930 \u0917\u0948\u0930-\u0935\u0948\u0926\u093f\u0915",
        "Saguna and Nirguna / \u0938\u0917\u0941\u0923 \u0914\u0930 \u0928\u093f\u0930\u094d\u0917\u0941\u0923",
        "Orthodox and Reformist / \u0930\u0942\u0922\u093c\u093f\u0935\u093e\u0926\u0940 \u0914\u0930 \u0938\u0941\u0927\u093e\u0930\u0935\u093e\u0926\u0940",
        "Shaiva and Vaishnava / \u0936\u0948\u0935 \u0914\u0930 \u0935\u0948\u0937\u094d\u0923\u0935"
      ],
      "correctIndex": 1,
      "explanation": "The Bhakti movement is broadly categorized into two schools of thought: Saguna (with attributes/form) and Nirguna (without attributes/formless). Saguna bhaktas (like Tulsidas, Surdas, Mirabai) worshipped God in specific forms like Rama or Krishna. Nirguna bhaktas (like Kabir, Nanak) worshipped the formless, abstract Divine. Both paths aimed for union with God through devotion. / \u092d\u0915\u094d\u0924\u093f \u0906\u0902\u0926\u094b\u0932\u0928 \u0915\u094b \u092e\u094b\u091f\u0947 \u0924\u094c\u0930 \u092a\u0930 \u0935\u093f\u091a\u093e\u0930 \u0915\u0940 \u0926\u094b \u0936\u094d\u0930\u0947\u0923\u093f\u092f\u094b\u0902 \u092e\u0947\u0902 \u0935\u0930\u094d\u0917\u0940\u0915\u0943\u0924 \u0915\u093f\u092f\u093e \u0917\u092f\u093e \u0939\u0948: \u0938\u0917\u0941\u0923 (\u0917\u0941\u0923\u094b\u0902/\u0930\u0942\u092a \u0915\u0947 \u0938\u093e\u0925) \u0914\u0930 \u0928\u093f\u0930\u094d\u0917\u0941\u0923 (\u092c\u093f\u0928\u093e \u0917\u0941\u0923\u094b\u0902 \u0915\u0947/\u0928\u093f\u0930\u093e\u0915\u093e\u0930)\u0964 \u0938\u0917\u0941\u0923 \u092d\u0915\u094d\u0924\u094b\u0902 (\u091c\u0948\u0938\u0947 \u0924\u0941\u0932\u0938\u0940\u0926\u093e\u0938, \u0938\u0942\u0930\u0926\u093e\u0938, \u092e\u0940\u0930\u093e\u092c\u093e\u0908) \u0928\u0947 \u0930\u093e\u092e \u092f\u093e \u0915\u0943\u0937\u094d\u0923 \u091c\u0948\u0938\u0947 \u0935\u093f\u0936\u093f\u0937\u094d\u091f \u0930\u0942\u092a\u094b\u0902 \u092e\u0947\u0902 \u0908\u0936\u094d\u0935\u0930 \u0915\u0940 \u092a\u0942\u091c\u093e \u0915\u0940\u0964 \u0928\u093f\u0930\u094d\u0917\u0941\u0923 \u092d\u0915\u094d\u0924\u094b\u0902 (\u091c\u0948\u0938\u0947 \u0915\u092c\u0940\u0930, \u0928\u093e\u0928\u0915) \u0928\u0947 \u0928\u093f\u0930\u093e\u0915\u093e\u0930, \u0905\u092e\u0942\u0930\u094d\u0924 \u092a\u0930\u092e\u093e\u0924\u094d\u092e\u093e \u0915\u0940 \u092a\u0942\u091c\u093e \u0915\u0940\u0964 \u0926\u094b\u0928\u094b\u0902 \u092e\u093e\u0930\u094d\u0917\u094b\u0902 \u0915\u093e \u0932\u0915\u094d\u0937\u094d\u092f \u092d\u0915\u094d\u0924\u093f \u0915\u0947 \u092e\u093e\u0927\u094d\u092f\u092e \u0938\u0947 \u0908\u0936\u094d\u0935\u0930 \u0915\u0947 \u0938\u093e\u0925 \u092e\u093f\u0932\u0928 \u0925\u093e\u0964",
      "reference": ""
    },
    {
      "text": "<b>Q4.</b> Q4. Which of the following best describes Annamacharya&#x27;s contribution to Indian devotional music? / \u0928\u093f\u092e\u094d\u0928\u0932\u093f\u0916\u093f\u0924 \u092e\u0947\u0902 \u0938\u0947 \u0915\u094c\u0928 \u092d\u093e\u0930\u0924\u0940\u092f \u092d\u0915\u094d\u0924\u093f \u0938\u0902\u0917\u0940\u0924 \u092e\u0947\u0902 \u0905\u0928\u094d\u0928\u092e\u093e\u091a\u093e\u0930\u094d\u092f \u0915\u0947 \u092f\u094b\u0917\u0926\u093e\u0928 \u0915\u093e \u0938\u092c\u0938\u0947 \u0905\u091a\u094d\u091b\u093e \u0935\u0930\u094d\u0923\u0928 \u0915\u0930\u0924\u093e \u0939\u0948? [SSC CGL Tier 1, 13 Sep 2025, Shift-1]",
      "options": [
        "Composed Sanskrit hymns on rituals / \u0905\u0928\u0941\u0937\u094d\u0920\u093e\u0928\u094b\u0902 \u092a\u0930 \u0938\u0902\u0938\u094d\u0915\u0943\u0924 \u092d\u091c\u0928\u094b\u0902 \u0915\u0940 \u0930\u091a\u0928\u093e \u0915\u0940",
        "Wrote 32,000 songs promoting equality / \u0938\u092e\u093e\u0928\u0924\u093e \u0915\u094b \u092c\u0922\u093c\u093e\u0935\u093e \u0926\u0947\u0928\u0947 \u0935\u093e\u0932\u0947 32,000 \u0917\u0940\u0924\u094b\u0902 \u0915\u0940 \u0930\u091a\u0928\u093e \u0915\u0940",
        "Restricted songs to temples only / \u0917\u0940\u0924\u094b\u0902 \u0915\u094b \u0915\u0947\u0935\u0932 \u092e\u0902\u0926\u093f\u0930\u094b\u0902 \u0924\u0915 \u0938\u0940\u092e\u093f\u0924 \u0930\u0916\u093e",
        "Focused only on melody, not reform / \u0915\u0947\u0935\u0932 \u0927\u0941\u0928 \u092a\u0930 \u0927\u094d\u092f\u093e\u0928 \u0915\u0947\u0902\u0926\u094d\u0930\u093f\u0924 \u0915\u093f\u092f\u093e, \u0938\u0941\u0927\u093e\u0930 \u092a\u0930 \u0928\u0939\u0940\u0902"
      ],
      "correctIndex": 1,
      "explanation": "Annamacharya (15th century), a Telugu saint-composer, is known as the \"Padakavita Pitamaha\" (Grandfather of song-writing). He is credited with composing around 32,000 sankirtanas (songs) in praise of Lord Venkateswara of Tirupati. His songs (Sringara and Adhyatma sankirtanas) were accessible to all and promoted social equality, opposing caste distinctions. He is the earliest known musician to compose songs in the 'Pallavi-Charanam' structure. / \u0924\u0947\u0932\u0941\u0917\u0941 \u0938\u0902\u0924-\u0938\u0902\u0917\u0940\u0924\u0915\u093e\u0930 \u0905\u0928\u094d\u0928\u092e\u093e\u091a\u093e\u0930\u094d\u092f (15\u0935\u0940\u0902 \u0936\u0924\u093e\u092c\u094d\u0926\u0940) \u0915\u094b \"\u092a\u0926\u0915\u0935\u093f\u0924\u093e \u092a\u093f\u0924\u093e\u092e\u0939\" (\u0917\u0940\u0924 \u0932\u0947\u0916\u0928 \u0915\u0947 \u0926\u093e\u0926\u093e) \u0915\u0947 \u0930\u0942\u092a \u092e\u0947\u0902 \u091c\u093e\u0928\u093e \u091c\u093e\u0924\u093e \u0939\u0948\u0964 \u0909\u0928\u094d\u0939\u0947\u0902 \u0924\u093f\u0930\u0941\u092a\u0924\u093f \u0915\u0947 \u092d\u0917\u0935\u093e\u0928 \u0935\u0947\u0902\u0915\u091f\u0947\u0936\u094d\u0935\u0930 \u0915\u0940 \u092a\u094d\u0930\u0936\u0902\u0938\u093e \u092e\u0947\u0902 \u0932\u0917\u092d\u0917 32,000 \u0938\u0902\u0915\u0940\u0930\u094d\u0924\u0928 (\u0917\u0940\u0924) \u0932\u093f\u0916\u0928\u0947 \u0915\u093e \u0936\u094d\u0930\u0947\u092f \u0926\u093f\u092f\u093e \u091c\u093e\u0924\u093e \u0939\u0948\u0964 \u0909\u0928\u0915\u0947 \u0917\u0940\u0924 (\u0936\u094d\u0930\u0943\u0902\u0917\u093e\u0930 \u0914\u0930 \u0905\u0927\u094d\u092f\u093e\u0924\u094d\u092e \u0938\u0902\u0915\u0940\u0930\u094d\u0924\u0928) \u0938\u092d\u0940 \u0915\u0947 \u0932\u093f\u090f \u0938\u0941\u0932\u092d \u0925\u0947 \u0914\u0930 \u091c\u093e\u0924\u093f\u0917\u0924 \u092d\u0947\u0926\u092d\u093e\u0935 \u0915\u093e \u0935\u093f\u0930\u094b\u0927 \u0915\u0930\u0924\u0947 \u0939\u0941\u090f \u0938\u093e\u092e\u093e\u091c\u093f\u0915 \u0938\u092e\u093e\u0928\u0924\u093e \u0915\u094b \u092c\u0922\u093c\u093e\u0935\u093e \u0926\u0947\u0924\u0947 \u0925\u0947\u0964 \u0935\u0939 '\u092a\u0932\u094d\u0932\u0935\u0940-\u091a\u0930\u0923\u092e' \u0938\u0902\u0930\u091a\u0928\u093e \u092e\u0947\u0902 \u0917\u0940\u0924 \u0932\u093f\u0916\u0928\u0947 \u0935\u093e\u0932\u0947 \u0938\u092c\u0938\u0947 \u092a\u0941\u0930\u093e\u0928\u0947 \u091c\u094d\u091e\u093e\u0924 \u0938\u0902\u0917\u0940\u0924\u0915\u093e\u0930 \u0939\u0948\u0902\u0964",
      "reference": ""
    },
    {
      "text": "<b>Q5.</b> Q5. Who authored &#x27;Bijak&#x27;, a collection of devotional poems and teachings? / \u092d\u0915\u094d\u0924\u093f \u0915\u0935\u093f\u0924\u093e\u0913\u0902 \u0914\u0930 \u0936\u093f\u0915\u094d\u0937\u093e\u0913\u0902 \u0915\u0947 \u0938\u0902\u0917\u094d\u0930\u0939 &#x27;\u092c\u0940\u091c\u0915&#x27; \u0915\u0947 \u0932\u0947\u0916\u0915 \u0915\u094c\u0928 \u0925\u0947? [SSC CHSL, 21 Nov 2025, Shift-1]",
      "options": [
        "Surdas / \u0938\u0942\u0930\u0926\u093e\u0938",
        "Raskhan / \u0930\u0938\u0916\u093e\u0928",
        "Kabir Das / \u0915\u092c\u0940\u0930 \u0926\u093e\u0938",
        "Mirabai / \u092e\u0940\u0930\u093e\u092c\u093e\u0908"
      ],
      "correctIndex": 2,
      "explanation": "Kabir Das (15th century), the Nirguna Bhakti saint, authored the 'Bijak'. It is the holy scripture of the Kabir Panth followers and contains his verses (dohas, sabads, ramainis). In his poetry, Kabir sharply criticized religious orthodoxy, rituals, and caste discrimination, emphasizing a direct, personal connection with the formless God. He wrote in a vernacular dialect known as 'Sadhukkadi'. / \u0928\u093f\u0930\u094d\u0917\u0941\u0923 \u092d\u0915\u094d\u0924\u093f \u0938\u0902\u0924 \u0915\u092c\u0940\u0930 \u0926\u093e\u0938 (15\u0935\u0940\u0902 \u0936\u0924\u093e\u092c\u094d\u0926\u0940) \u0928\u0947 '\u092c\u0940\u091c\u0915' \u0915\u0940 \u0930\u091a\u0928\u093e \u0915\u0940 \u0925\u0940\u0964 \u092f\u0939 \u0915\u092c\u0940\u0930 \u092a\u0902\u0925 \u0915\u0947 \u0905\u0928\u0941\u092f\u093e\u092f\u093f\u092f\u094b\u0902 \u0915\u093e \u092a\u0935\u093f\u0924\u094d\u0930 \u0917\u094d\u0930\u0902\u0925 \u0939\u0948 \u0914\u0930 \u0907\u0938\u092e\u0947\u0902 \u0909\u0928\u0915\u0947 \u091b\u0902\u0926 (\u0926\u094b\u0939\u0947, \u0936\u092c\u094d\u0926, \u0930\u092e\u0948\u0928\u0940) \u0936\u093e\u092e\u093f\u0932 \u0939\u0948\u0902\u0964 \u0905\u092a\u0928\u0940 \u0915\u0935\u093f\u0924\u093e \u092e\u0947\u0902, \u0915\u092c\u0940\u0930 \u0928\u0947 \u0927\u093e\u0930\u094d\u092e\u093f\u0915 \u0930\u0942\u0922\u093c\u093f\u0935\u093e\u0926\u093f\u0924\u093e, \u0905\u0928\u0941\u0937\u094d\u0920\u093e\u0928\u094b\u0902 \u0914\u0930 \u091c\u093e\u0924\u093f\u0917\u0924 \u092d\u0947\u0926\u092d\u093e\u0935 \u0915\u0940 \u0924\u0940\u0916\u0940 \u0906\u0932\u094b\u091a\u0928\u093e \u0915\u0940, \u0914\u0930 \u0928\u093f\u0930\u093e\u0915\u093e\u0930 \u0908\u0936\u094d\u0935\u0930 \u0915\u0947 \u0938\u093e\u0925 \u0938\u0940\u0927\u0947, \u0935\u094d\u092f\u0915\u094d\u0924\u093f\u0917\u0924 \u0938\u0902\u092c\u0902\u0927 \u092a\u0930 \u091c\u094b\u0930 \u0926\u093f\u092f\u093e\u0964 \u0909\u0928\u094d\u0939\u094b\u0902\u0928\u0947 '\u0938\u0927\u0941\u0915\u094d\u0915\u0921\u093c\u0940' \u0928\u093e\u092e\u0915 \u0938\u094d\u0925\u093e\u0928\u0940\u092f \u092c\u094b\u0932\u0940 \u092e\u0947\u0902 \u0932\u093f\u0916\u093e\u0964",
      "reference": ""
    },
    {
      "text": "<b>Q6.</b> Q6. Veerashaiva movement begun in ______ in the mid-twelfth century. / \u0935\u0940\u0930\u0936\u0948\u0935 \u0906\u0902\u0926\u094b\u0932\u0928 \u092c\u093e\u0930\u0939\u0935\u0940\u0902 \u0936\u0924\u093e\u092c\u094d\u0926\u0940 \u0915\u0947 \u092e\u0927\u094d\u092f \u092e\u0947\u0902 ______ \u092e\u0947\u0902 \u0936\u0941\u0930\u0942 \u0939\u0941\u0906 \u0925\u093e\u0964 [SSC CHSL, 26 Nov 2025, Shift-3]",
      "options": [
        "Karnataka / \u0915\u0930\u094d\u0928\u093e\u091f\u0915",
        "Assam / \u0905\u0938\u092e",
        "Bengal / \u092c\u0902\u0917\u093e\u0932",
        "Maharashtra / \u092e\u0939\u093e\u0930\u093e\u0937\u094d\u091f\u094d\u0930"
      ],
      "correctIndex": 0,
      "explanation": "The Veerashaiva (or Lingayat) movement began in Karnataka in the mid-12th century. It was led by Basavanna, a minister in the court of the Kalachuri king Bijjala, along with other sharanas like Allama Prabhu and Akka Mahadevi. The movement challenged the caste system and brahminical orthodoxy, promoting equality and devotion to Shiva (Ishtalinga). They expressed their teachings through 'Vachanas' (prose-poetry). / \u0935\u0940\u0930\u0936\u0948\u0935 (\u092f\u093e \u0932\u093f\u0902\u0917\u093e\u092f\u0924) \u0906\u0902\u0926\u094b\u0932\u0928 12\u0935\u0940\u0902 \u0936\u0924\u093e\u092c\u094d\u0926\u0940 \u0915\u0947 \u092e\u0927\u094d\u092f \u092e\u0947\u0902 \u0915\u0930\u094d\u0928\u093e\u091f\u0915 \u092e\u0947\u0902 \u0936\u0941\u0930\u0942 \u0939\u0941\u0906 \u0925\u093e\u0964 \u0907\u0938\u0915\u093e \u0928\u0947\u0924\u0943\u0924\u094d\u0935 \u0915\u0932\u091a\u0941\u0930\u0940 \u0930\u093e\u091c\u093e \u092c\u093f\u091c\u094d\u091c\u0932 \u0915\u0947 \u0926\u0930\u092c\u093e\u0930 \u092e\u0947\u0902 \u092e\u0902\u0924\u094d\u0930\u0940 \u092c\u0938\u0935\u0928\u094d\u0928\u093e \u0928\u0947 \u0915\u093f\u092f\u093e \u0925\u093e, \u0938\u093e\u0925 \u0939\u0940 \u0905\u0932\u094d\u0932\u093e\u092e\u093e \u092a\u094d\u0930\u092d\u0941 \u0914\u0930 \u0905\u0915\u094d\u0915\u093e \u092e\u0939\u093e\u0926\u0947\u0935\u0940 \u091c\u0948\u0938\u0947 \u0905\u0928\u094d\u092f \u0936\u0930\u0923\u094b\u0902 \u0928\u0947 \u092d\u0940 \u0915\u093f\u092f\u093e \u0925\u093e\u0964 \u0907\u0938 \u0906\u0902\u0926\u094b\u0932\u0928 \u0928\u0947 \u091c\u093e\u0924\u093f \u0935\u094d\u092f\u0935\u0938\u094d\u0925\u093e \u0914\u0930 \u092c\u094d\u0930\u093e\u0939\u094d\u092e\u0923\u0935\u093e\u0926\u0940 \u0930\u0942\u0922\u093c\u093f\u0935\u093e\u0926\u093f\u0924\u093e \u0915\u094b \u091a\u0941\u0928\u094c\u0924\u0940 \u0926\u0940, \u0938\u092e\u093e\u0928\u0924\u093e \u0914\u0930 \u0936\u093f\u0935 (\u0907\u0937\u094d\u091f\u0932\u093f\u0902\u0917) \u0915\u0947 \u092a\u094d\u0930\u0924\u093f \u092d\u0915\u094d\u0924\u093f \u0915\u094b \u092c\u0922\u093c\u093e\u0935\u093e \u0926\u093f\u092f\u093e\u0964 \u0909\u0928\u094d\u0939\u094b\u0902\u0928\u0947 '\u0935\u091a\u0928\u094b\u0902' (\u0917\u0926\u094d\u092f-\u0915\u0935\u093f\u0924\u093e) \u0915\u0947 \u092e\u093e\u0927\u094d\u092f\u092e \u0938\u0947 \u0905\u092a\u0928\u0940 \u0936\u093f\u0915\u094d\u0937\u093e\u0913\u0902 \u0915\u094b \u0935\u094d\u092f\u0915\u094d\u0924 \u0915\u093f\u092f\u093e\u0964",
      "reference": ""
    },
    {
      "text": "<b>Q7.</b> Q7. In which of the following are the songs of Alvar saints compiled? / \u0928\u093f\u092e\u094d\u0928\u0932\u093f\u0916\u093f\u0924 \u092e\u0947\u0902 \u0938\u0947 \u0915\u093f\u0938\u092e\u0947\u0902 \u0905\u0932\u0935\u0930 \u0938\u0902\u0924\u094b\u0902 \u0915\u0947 \u0917\u0940\u0924\u094b\u0902 \u0915\u093e \u0938\u0902\u0915\u0932\u0928 \u0915\u093f\u092f\u093e \u0917\u092f\u093e \u0939\u0948? [SSC CHSL, 27 Nov 2025, Shift-1]",
      "options": [
        "Divya Prabandham / \u0926\u093f\u0935\u094d\u092f \u092a\u094d\u0930\u092c\u0902\u0927\u092e",
        "Ettutogai / \u090f\u091f\u094d\u091f\u0941\u091f\u094b\u0917\u0908",
        "Tipitaka / \u0924\u094d\u0930\u093f\u092a\u093f\u091f\u0915",
        "Adi-Puran / \u0906\u0926\u093f-\u092a\u0941\u0930\u093e\u0923"
      ],
      "correctIndex": 0,
      "explanation": "The songs of the Alvar saints (12 Vaishnavite saints of Tamil Nadu) are compiled in the Nalayira Divya Prabandham (Four Thousand Divine Hymns). This collection is often referred to as the \"Tamil Veda.\" It was compiled by Nathamuni in the 9th-10th century. The Alvars, including the female saint Andal, sang passionate hymns in praise of Vishnu and his avatars. / \u0905\u0932\u0935\u0930 \u0938\u0902\u0924\u094b\u0902 (\u0924\u092e\u093f\u0932\u0928\u093e\u0921\u0941 \u0915\u0947 12 \u0935\u0948\u0937\u094d\u0923\u0935 \u0938\u0902\u0924) \u0915\u0947 \u0917\u0940\u0924\u094b\u0902 \u0915\u094b '\u0928\u093e\u0932\u092f\u093f\u0930\u093e \u0926\u093f\u0935\u094d\u092f \u092a\u094d\u0930\u092c\u0902\u0927\u092e' (\u091a\u093e\u0930 \u0939\u091c\u093e\u0930 \u0926\u093f\u0935\u094d\u092f \u092d\u091c\u0928) \u092e\u0947\u0902 \u0938\u0902\u0915\u0932\u093f\u0924 \u0915\u093f\u092f\u093e \u0917\u092f\u093e \u0939\u0948\u0964 \u0907\u0938 \u0938\u0902\u0917\u094d\u0930\u0939 \u0915\u094b \u0905\u0915\u094d\u0938\u0930 \"\u0924\u092e\u093f\u0932 \u0935\u0947\u0926\" \u0915\u0939\u093e \u091c\u093e\u0924\u093e \u0939\u0948\u0964 \u0907\u0938\u0947 9\u0935\u0940\u0902-10\u0935\u0940\u0902 \u0936\u0924\u093e\u092c\u094d\u0926\u0940 \u092e\u0947\u0902 \u0928\u093e\u0925\u092e\u092e\u0941\u0928\u093f \u0926\u094d\u0935\u093e\u0930\u093e \u0938\u0902\u0915\u0932\u093f\u0924 \u0915\u093f\u092f\u093e \u0917\u092f\u093e \u0925\u093e\u0964 \u092e\u0939\u093f\u0932\u093e \u0938\u0902\u0924 \u0905\u0902\u0921\u093e\u0932 \u0938\u0939\u093f\u0924 \u0905\u0932\u0935\u0930\u094b\u0902 \u0928\u0947 \u0935\u093f\u0937\u094d\u0923\u0941 \u0914\u0930 \u0909\u0928\u0915\u0947 \u0905\u0935\u0924\u093e\u0930\u094b\u0902 \u0915\u0940 \u092a\u094d\u0930\u0936\u0902\u0938\u093e \u092e\u0947\u0902 \u092d\u093e\u0935\u092a\u0942\u0930\u094d\u0923 \u092d\u091c\u0928 \u0917\u093e\u090f\u0964",
      "reference": ""
    },
    {
      "text": "<b>Q8.</b> Q8. What was the total number of Alvar saints in the Bhakti movement tradition? / \u092d\u0915\u094d\u0924\u093f \u0906\u0902\u0926\u094b\u0932\u0928 \u092a\u0930\u0902\u092a\u0930\u093e \u092e\u0947\u0902 \u0905\u0932\u0935\u0930 \u0938\u0902\u0924\u094b\u0902 \u0915\u0940 \u0915\u0941\u0932 \u0938\u0902\u0916\u094d\u092f\u093e \u0915\u093f\u0924\u0928\u0940 \u0925\u0940? [SSC CHSL, 27 Nov 2025, Shift-2]",
      "options": [
        "12 / 12",
        "29 / 29",
        "44 / 44",
        "63 / 63"
      ],
      "correctIndex": 0,
      "explanation": "There were traditionally 12 Alvar saints. They were Tamil poet-saints who espoused 'bhakti' (devotion) to Lord Vishnu. Prominent Alvars include Nammalvar, Periyalvar, and Andal (the only woman). In contrast, the Nayanars (Shaivite saints) numbered 63. The Alvars and Nayanars spearheaded the Bhakti movement in South India between the 6th and 9th centuries. / \u092a\u093e\u0930\u0902\u092a\u0930\u093f\u0915 \u0930\u0942\u092a \u0938\u0947 12 \u0905\u0932\u0935\u0930 \u0938\u0902\u0924 \u0925\u0947\u0964 \u0935\u0947 \u0924\u092e\u093f\u0932 \u0915\u0935\u093f-\u0938\u0902\u0924 \u0925\u0947 \u091c\u093f\u0928\u094d\u0939\u094b\u0902\u0928\u0947 \u092d\u0917\u0935\u093e\u0928 \u0935\u093f\u0937\u094d\u0923\u0941 \u0915\u0947 \u092a\u094d\u0930\u0924\u093f '\u092d\u0915\u094d\u0924\u093f' \u0915\u093e \u092a\u094d\u0930\u091a\u093e\u0930 \u0915\u093f\u092f\u093e\u0964 \u092a\u094d\u0930\u092e\u0941\u0916 \u0905\u0932\u0935\u0930\u094b\u0902 \u092e\u0947\u0902 \u0928\u092e\u094d\u092e\u093e\u0932\u0935\u0930, \u092a\u0947\u0930\u093f\u092f\u093e\u0932\u0935\u0930 \u0914\u0930 \u0905\u0902\u0921\u093e\u0932 (\u090f\u0915\u092e\u093e\u0924\u094d\u0930 \u092e\u0939\u093f\u0932\u093e) \u0936\u093e\u092e\u093f\u0932 \u0939\u0948\u0902\u0964 \u0907\u0938\u0915\u0947 \u0935\u093f\u092a\u0930\u0940\u0924, \u0928\u092f\u0928\u093e\u0930\u094b\u0902 (\u0936\u0948\u0935 \u0938\u0902\u0924\u094b\u0902) \u0915\u0940 \u0938\u0902\u0916\u094d\u092f\u093e 63 \u0925\u0940\u0964 \u0905\u0932\u0935\u0930\u094b\u0902 \u0914\u0930 \u0928\u092f\u0928\u093e\u0930\u094b\u0902 \u0928\u0947 6\u0935\u0940\u0902 \u0914\u0930 9\u0935\u0940\u0902 \u0936\u0924\u093e\u092c\u094d\u0926\u0940 \u0915\u0947 \u092c\u0940\u091a \u0926\u0915\u094d\u0937\u093f\u0923 \u092d\u093e\u0930\u0924 \u092e\u0947\u0902 \u092d\u0915\u094d\u0924\u093f \u0906\u0902\u0926\u094b\u0932\u0928 \u0915\u093e \u0928\u0947\u0924\u0943\u0924\u094d\u0935 \u0915\u093f\u092f\u093e\u0964",
      "reference": ""
    },
    {
      "text": "<b>Q9.</b> Q9. Nayanars saints were devoted to which of the following? / \u0928\u092f\u0928\u093e\u0930 \u0938\u0902\u0924 \u0928\u093f\u092e\u094d\u0928\u0932\u093f\u0916\u093f\u0924 \u092e\u0947\u0902 \u0938\u0947 \u0915\u093f\u0938\u0915\u0947 \u092d\u0915\u094d\u0924 \u0925\u0947? [SSC CHSL, 29 Nov 2025, Shift-2]",
      "options": [
        "Shiva / \u0936\u093f\u0935",
        "Durga / \u0926\u0941\u0930\u094d\u0917\u093e",
        "Agni / \u0905\u0917\u094d\u0928\u093f",
        "Indra / \u0907\u0902\u0926\u094d\u0930"
      ],
      "correctIndex": 0,
      "explanation": "The Nayanars were a group of 63 Tamil saints who were devoted to Lord Shiva. They lived between the 6th and 8th centuries CE and played a crucial role in the revival of Hinduism (Shaivism) in South India, countering the influence of Buddhism and Jainism. Their hymns are compiled in the 'Tirumurai', with the 'Tevaram' (by Appar, Sambandar, and Sundarar) being the most famous. / \u0928\u092f\u0928\u093e\u0930 63 \u0924\u092e\u093f\u0932 \u0938\u0902\u0924\u094b\u0902 \u0915\u093e \u090f\u0915 \u0938\u092e\u0942\u0939 \u0925\u093e \u091c\u094b \u092d\u0917\u0935\u093e\u0928 \u0936\u093f\u0935 \u0915\u0947 \u092d\u0915\u094d\u0924 \u0925\u0947\u0964 \u0935\u0947 6\u0935\u0940\u0902 \u0914\u0930 8\u0935\u0940\u0902 \u0936\u0924\u093e\u092c\u094d\u0926\u0940 \u0908\u0938\u094d\u0935\u0940 \u0915\u0947 \u092c\u0940\u091a \u0930\u0939\u0947 \u0914\u0930 \u0909\u0928\u094d\u0939\u094b\u0902\u0928\u0947 \u092c\u094c\u0926\u094d\u0927 \u0914\u0930 \u091c\u0948\u0928 \u0927\u0930\u094d\u092e \u0915\u0947 \u092a\u094d\u0930\u092d\u093e\u0935 \u0915\u093e \u092e\u0941\u0915\u093e\u092c\u0932\u093e \u0915\u0930\u0924\u0947 \u0939\u0941\u090f \u0926\u0915\u094d\u0937\u093f\u0923 \u092d\u093e\u0930\u0924 \u092e\u0947\u0902 \u0939\u093f\u0902\u0926\u0942 \u0927\u0930\u094d\u092e (\u0936\u0948\u0935 \u0927\u0930\u094d\u092e) \u0915\u0947 \u092a\u0941\u0928\u0930\u0941\u0926\u094d\u0927\u093e\u0930 \u092e\u0947\u0902 \u092e\u0939\u0924\u094d\u0935\u092a\u0942\u0930\u094d\u0923 \u092d\u0942\u092e\u093f\u0915\u093e \u0928\u093f\u092d\u093e\u0908\u0964 \u0909\u0928\u0915\u0947 \u092d\u091c\u0928\u094b\u0902 \u0915\u094b '\u0924\u093f\u0930\u0941\u092e\u0941\u0930\u093e\u0908' \u092e\u0947\u0902 \u0938\u0902\u0915\u0932\u093f\u0924 \u0915\u093f\u092f\u093e \u0917\u092f\u093e \u0939\u0948, \u091c\u093f\u0938\u092e\u0947\u0902 '\u0924\u0947\u0935\u0930\u092e' (\u0905\u092a\u094d\u092a\u093e\u0930, \u0938\u092e\u094d\u092c\u0902\u0926\u0930 \u0914\u0930 \u0938\u0941\u0902\u0926\u0930\u0930 \u0926\u094d\u0935\u093e\u0930\u093e) \u0938\u092c\u0938\u0947 \u092a\u094d\u0930\u0938\u093f\u0926\u094d\u0927 \u0939\u0948\u0964",
      "reference": ""
    }
  ],
  "leaderboard": {
    "rankings": [],
    "question_stats": {
      "0": {
        "correct": 0,
        "total": 0
      },
      "1": {
        "correct": 0,
        "total": 0
      },
      "2": {
        "correct": 0,
        "total": 0
      },
      "3": {
        "correct": 0,
        "total": 0
      },
      "4": {
        "correct": 0,
        "total": 0
      },
      "5": {
        "correct": 0,
        "total": 0
      },
      "6": {
        "correct": 0,
        "total": 0
      },
      "7": {
        "correct": 0,
        "total": 0
      },
      "8": {
        "correct": 0,
        "total": 0
      }
    }
  }
};

(function(){
  // ----- Config from quizData.settings -----
  const TOTAL_TIME = (quizData.settings && quizData.settings.totalTimeSec) || 20*60;
  const NEGATIVE = (quizData.settings && quizData.settings.negativeMarkPerWrong) || (1/3);

  // ----- State -----
  const state = {
    current: 0,
    answers: Array(quizData.questions.length).fill(null),
    markedForReview: Array(quizData.questions.length).fill(false),
    startTime: new Date(),
    timePerQ: Array(quizData.questions.length).fill(0),
    submitted: false,
    inReviewMode: false,
    darkMode: false,
    totalTime: TOTAL_TIME,
    negativeMark: NEGATIVE,
    avgTime: 0,
    timerInterval: null,
    qTimerInterval: null,
    lastSoundIdx: -1,
    currentLang: 'both', // 'both', 'hn', 'en'
    rootFontSize: 16
  };

  // ----- Elements -----
  const questionArea = document.getElementById('questionArea');
  const resultsContainer = document.getElementById('resultsContainer');
  const submitBtn = document.getElementById('submitBtn');
  const qListGrid = document.getElementById('qList');
  const themeToggle = document.getElementById('themeToggle');
  const clickSound = document.getElementById('clickSound');
  const correctSound = document.getElementById('correctSound');
  const wrongSound = document.getElementById('wrongSound');
  const quizNav = document.getElementById('quizNav');
  const langToggleBtn = document.getElementById('langToggleBtn');

  // ----- Init -----
  document.addEventListener('DOMContentLoaded', () => {
    setupHomePage();
    document.getElementById('startQuizBtn').addEventListener('click', startQuiz);
  });

  function setupHomePage() {
    const totalQuestions = quizData.questions.length;
    const totalTimeMinutes = Math.floor(quizData.settings.totalTimeSec / 60);
    const negativeMark = quizData.settings.negativeMarkPerWrong;

    // Linkify Topic Name logic
    let rawTopic = quizData.settings.topic || "General Knowledge";

    // Sanitize HTML entities to prevent XSS
    rawTopic = rawTopic.replace(/&/g, "&amp;")
                       .replace(/</g, "&lt;")
                       .replace(/>/g, "&gt;")
                       .replace(/"/g, "&quot;")
                       .replace(/'/g, "&#039;");

    // Regex to detect URLs and convert to <a> tags
    const topicWithLinks = rawTopic.replace(/(https?:\/\/[^\s]+)/g, (url) => {
        return `<a href="${url}" target="_blank" style="color: var(--primary); text-decoration: underline; font-weight: bold; position: relative; z-index: 10;">${url}</a>`;
    });

    document.getElementById('homeTopic').innerHTML = topicWithLinks;
    document.getElementById('homeQuestions').textContent = totalQuestions;
    document.getElementById('homeTime').textContent = `${totalTimeMinutes} Minutes`;
    document.getElementById('homeNegative').textContent = negativeMark > 0 ? `-${negativeMark} per wrong answer` : "No negative marking";

    initTheme(); // Init theme on home page as well
  }

  function startQuiz() {
    document.getElementById('home-screen').style.display = 'none';
    document.getElementById('quiz-screen').style.display = 'block';
    initQuiz();
  }

  function initQuiz() {
    buildQuestionTiles();
    renderQuestion(0);
    initTimer();
    initNav();
    initFullscreen();
    initFontSizeControls();
    initLanguageSwitcher();
    initSwipeNavigation();
    updateStats();
    quizNav.style.display = 'flex';
  }

  function initNav(){
    submitBtn.addEventListener('click', () => {
        if (confirm('Are you sure you want to submit the quiz?')) {
            submitQuiz();
        }
    });

    // Mobile Sidebar Toggles
    const infoSidebar = document.getElementById('infoSidebar');
    const paletteSidebar = document.getElementById('paletteSidebar');
    const overlay = document.getElementById('overlay');
    const openInfo = document.getElementById('openInfoSidebar');
    const closeInfo = document.getElementById('closeInfoSidebar');
    const openPalette = document.getElementById('openPaletteSidebar');
    const closePalette = document.getElementById('closePaletteSidebar');

    const toggleSidebar = (sidebar, action) => {
        sidebar.classList[action]('show');
        overlay.classList[action]('show');
    };

    openInfo.addEventListener('click', () => toggleSidebar(infoSidebar, 'add'));
    closeInfo.addEventListener('click', () => toggleSidebar(infoSidebar, 'remove'));
    openPalette.addEventListener('click', () => toggleSidebar(paletteSidebar, 'add'));
    closePalette.addEventListener('click', () => toggleSidebar(paletteSidebar, 'remove'));
    overlay.addEventListener('click', () => {
        toggleSidebar(infoSidebar, 'remove');
        toggleSidebar(paletteSidebar, 'remove');
    });

    // keyboard
    document.addEventListener('keydown',(e)=>{
      if(e.target.tagName === 'INPUT') return;
      if(e.key==='ArrowLeft') go(-1);
      if(e.key==='ArrowRight') go(1);
    });
  }

  function initTheme(){
    const saved = localStorage.getItem('qa_theme');
    if(saved==='dark'){ 
        document.body.classList.add('dark-mode'); 
        state.darkMode=true; 
    }
    updateThemeIcon();
    themeToggle.addEventListener('click', ()=>{
      state.darkMode = !state.darkMode;
      document.body.classList.toggle('dark-mode', state.darkMode);
      localStorage.setItem('qa_theme', state.darkMode?'dark':'light');
      updateThemeIcon();
      if(state.submitted) buildCharts(state.lastResultData);
    });
  }
  function updateThemeIcon(){
    const i = themeToggle.querySelector('i');
    i.classList.toggle('fa-moon', !state.darkMode);
    i.classList.toggle('fa-sun',  state.darkMode);
  }

  function initFullscreen() {
    const toggleBtn = document.getElementById('fullscreenToggle');
    if (!toggleBtn) return;

    toggleBtn.addEventListener('click', () => {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen().catch(err => {
                console.error(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);
            });
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }
    });

    document.addEventListener('fullscreenchange', () => {
        const icon = toggleBtn.querySelector('i');
        if (document.fullscreenElement) {
            icon.classList.remove('fa-expand');
            icon.classList.add('fa-compress');
        } else {
            icon.classList.remove('fa-compress');
            icon.classList.add('fa-expand');
        }
    });
  }

  function initFontSizeControls() {
      const increaseBtn = document.getElementById('fontIncreaseBtn');
      const decreaseBtn = document.getElementById('fontDecreaseBtn');
      const docEl = document.documentElement;

      increaseBtn.addEventListener('click', () => {
          state.rootFontSize = Math.min(22, state.rootFontSize + 1);
          docEl.style.fontSize = state.rootFontSize + 'px';
      });

      decreaseBtn.addEventListener('click', () => {
          state.rootFontSize = Math.max(12, state.rootFontSize - 1);
          docEl.style.fontSize = state.rootFontSize + 'px';
      });
  }

  function initLanguageSwitcher() {
      // Toggle order: Both -> Hindi -> English -> Both
      const langOrder = ['both', 'hn', 'en'];

      langToggleBtn.addEventListener('click', () => {
          const currentIndex = langOrder.indexOf(state.currentLang);
          const nextIndex = (currentIndex + 1) % langOrder.length;
          state.currentLang = langOrder[nextIndex];

          updateLangButton();
          renderQuestion(state.current);
      });
  }

  function updateLangButton() {
      let label = 'BILI';
      if (state.currentLang === 'hn') label = 'HIN';
      if (state.currentLang === 'en') label = 'ENG';
      langToggleBtn.textContent = label;
  }

  function translateText(text) {
      if (!text) return text;
      if (state.currentLang === 'both') return text;

      // Check if string has HTML tags to decide between simple split and DOM traversal
      const hasTags = /<[a-z][\s\S]*>/i.test(text);

      if (hasTags) {
          const div = document.createElement('div');
          div.innerHTML = text;
          walkAndTranslate(div);
          return div.innerHTML;
      } else {
          // Plain text path
          if (text.includes(' / ')) {
              const parts = text.split(' / ');
              if (parts.length >= 2) {
                  const en = parts[0];
                  const hn = parts.slice(1).join(' / ');
                  return state.currentLang === 'hn' ? hn.trim() : en.trim();
              }
          }
          return text;
      }
  }

  function walkAndTranslate(node) {
      if (node.nodeType === 3) { // Text node
          const val = node.nodeValue;
          if (val && val.includes(' / ')) {
              const parts = val.split(' / ');
              if (parts.length >= 2) {
                  const en = parts[0];
                  const hn = parts.slice(1).join(' / ');
                  node.nodeValue = state.currentLang === 'hn' ? hn.trim() : en.trim();
              }
          }
      } else if (node.nodeType === 1) { // Element node
          for (let i = 0; i < node.childNodes.length; i++) {
              walkAndTranslate(node.childNodes[i]);
          }
      }
  }


  function initSwipeNavigation() {
    let touchStartX = 0;
    let touchEndX = 0;
    let touchStartY = 0;
    let touchEndY = 0;
    const swipeThreshold = 50; // Minimum distance for a swipe
    const swipeRatio = 0.5; // Vertical distance should be less than half of horizontal

    const swipeArea = document.querySelector('.quiz-main');

    swipeArea.addEventListener('touchstart', (e) => {
        touchStartX = e.changedTouches[0].screenX;
        touchStartY = e.changedTouches[0].screenY;
    }, { passive: true });

    swipeArea.addEventListener('touchend', (e) => {
        touchEndX = e.changedTouches[0].screenX;
        touchEndY = e.changedTouches[0].screenY;
        handleSwipe();
    }, { passive: true });

    function handleSwipe() {
        if (state.submitted && !state.inReviewMode) return;

        const dx = touchEndX - touchStartX;
        const dy = touchEndY - touchStartY;

        if (Math.abs(dx) > swipeThreshold && Math.abs(dy) < Math.abs(dx) * swipeRatio) {
            if (dx < 0) {
                go(1); // Swiped left
            } else {
                go(-1); // Swiped right
            }
        }
    }
  }

  // ----- Timer -----
  function initTimer(){
    const start = Date.now();
    const duration = state.totalTime*1000;
    const end = start + duration;
    tick(); state.timerInterval = setInterval(tick, 1000);
    function tick(){
      const now = Date.now();
      const left = Math.max(0, end-now);
      const m = String(Math.floor(left/60000)).padStart(2,'0');
      const s = String(Math.floor((left%60000)/1000)).padStart(2,'0');

      // Sidebar timer
      document.getElementById('minutes').textContent = m;
      document.getElementById('seconds').textContent = s;

      // Header timer (NEW)
      const headerTimer = document.getElementById('headerTimerDisp');
      if(headerTimer) headerTimer.textContent = `${m}:${s}`;

      const pct = (left/duration)*100;
      const bar = document.getElementById('timeProgress');
      bar.style.width = pct + '%';
      if(left<=0){ clearInterval(state.timerInterval); submitQuiz(); }
      else if(pct<25) bar.className='progress-bar bg-danger';
      else if(pct<50) bar.className='progress-bar bg-warning';
      else bar.className='progress-bar bg-primary';
    }
  }

  // ----- Sidebar tiles -----
  function buildQuestionTiles(){
    qListGrid.innerHTML = '';
    quizData.questions.forEach((_,i)=>{
      const d = document.createElement('div');
      d.className='q-tile'; d.textContent=i+1;
      d.addEventListener('click', ()=>{
        if(!state.submitted) updateTime();
        renderQuestion(i);
        document.getElementById('paletteSidebar').classList.remove('show');
        document.getElementById('overlay').classList.remove('show');
      });
      qListGrid.appendChild(d);
    });
  }

  function updateTiles(){
    document.querySelectorAll('.q-tile').forEach((el,idx)=>{
      el.className='q-tile'; // Reset
      if(state.submitted){
          if(state.answers[idx] === quizData.questions[idx].correctIndex) el.classList.add('review-correct');
          else if(state.answers[idx] !== null) el.classList.add('review-incorrect');
          else el.classList.add('review-unattempted');
      } else {
        if(state.answers[idx] !== null) el.classList.add('answered');
        if(state.markedForReview[idx]) el.classList.add('marked');
      }
      if(idx === state.current) el.classList.add('current');
    });
  }

  // ----- Render question -----
  function renderQuestion(idx){
    if (idx < 0 || idx >= quizData.questions.length) return;

    // Stop previous Question Timer
    if (state.qTimerInterval) clearInterval(state.qTimerInterval);

    state.current=idx;
    const q=quizData.questions[idx];

    // Live Accuracy Calculation
    let accuracyBadge = '';
    if (quizData.leaderboard && quizData.leaderboard.question_stats && quizData.leaderboard.question_stats[idx]) {
        const stats = quizData.leaderboard.question_stats[idx];
        if(stats.total > 0) {
            const acc = Math.round((stats.correct / stats.total) * 100);
            accuracyBadge = `<span class="q-accuracy ms-2" title="Based on ${stats.total} Telegram users"><i class="fas fa-bullseye me-1"></i>${acc}%</span>`;
        }
    }

    // Question Card HTML
    let questionHtml=`
      <div class="card-ui">
        <div class="d-flex justify-content-between align-items-center">
            <div class="q-meta-container">
                <h5 class="fw-bold m-0">Question ${idx+1}</h5>
                <span class="q-timer"><i class="fas fa-stopwatch me-1"></i><span id="qTimerDisp">0s</span></span>
                ${accuracyBadge}
            </div>
            ${q.reference ? `<div class="small opacity-75">${q.reference}</div>` : ''}
        </div>
        <div class="q-text">${translateText(q.text)}</div>
        <div class="options">`;
    q.options.forEach((opt,i)=>{
      let cls='option-btn';
      if(state.answers[idx]===i) cls+=' selected';
      if(state.submitted){
        if(i===q.correctIndex) cls+=' correct';
        else if(state.answers[idx]===i) cls+=' incorrect';
      }
      questionHtml += `<button class="${cls}" data-i="${i}">${translateText(opt)}</button>`;
    });
    const translatedExplanation = translateText(q.explanation || 'Not available.');
    questionHtml += `</div>
        ${state.submitted ? `<div class="explanation mt-3"><strong>Explanation:</strong> ${translatedExplanation}</div>` : ''}
      </div>
    `;
    questionArea.innerHTML = questionHtml;

    // Start per-question timer logic (Visual only)
    if (!state.submitted) {
        // Start from time already spent
        let secondsSpent = Math.floor(state.timePerQ[idx] || 0);
        const timerEl = document.getElementById('qTimerDisp');
        if(timerEl) {
            timerEl.textContent = secondsSpent + 's';
            state.qTimerInterval = setInterval(() => {
                secondsSpent++;
                timerEl.textContent = secondsSpent + 's';
            }, 1000);
        }
    } else {
        // Show static time if submitted
         const timerEl = document.getElementById('qTimerDisp');
         if(timerEl) timerEl.textContent = Math.floor(state.timePerQ[idx] || 0) + 's';
    }


    // Navigation Buttons HTML
    let buttonsHtml = `
      <button id="prevBtn" class="btn btn-outline-secondary btn-nav"><i class="fas fa-chevron-left me-2"></i>Previous</button>
      <button id="markBtn" class="btn btn-outline-info btn-nav">
          ${state.markedForReview[idx] ? '<i class="fas fa-bookmark me-2"></i>Unmark' : '<i class="far fa-bookmark me-2"></i>Mark for Review'}
      </button>
      <button id="nextBtn" class="btn btn-primary btn-nav">Next<i class="fas fa-chevron-right ms-2"></i></button>
    `;
    quizNav.innerHTML = buttonsHtml;


    // Add event listeners to new elements
    document.getElementById('prevBtn').addEventListener('click', () => go(-1));
    document.getElementById('nextBtn').addEventListener('click', () => go(1));
    document.getElementById('markBtn').addEventListener('click', toggleMark);

    if(state.submitted) {
        document.getElementById('markBtn').style.display = 'none';
    }

    document.querySelectorAll('.option-btn').forEach(btn=>{
      btn.addEventListener('click',()=>{
        if(state.submitted) return;
        clickSound.currentTime=0; clickSound.play();
        const i = parseInt(btn.dataset.i);
        state.answers[state.current] = (state.answers[state.current] === i) ? null : i; // Allow un-selecting
        renderQuestion(state.current); // Re-render to show selection change
        updateStats();
        updateTiles();
      });
    });

    updateTiles();
    updateProgress();

    // Sound for review mode
    if(state.inReviewMode && state.lastSoundIdx!==idx){
      state.lastSoundIdx=idx;
      const isAttempted = state.answers[idx]!==null;
      const isCorrect = isAttempted && state.answers[idx]===q.correctIndex;
      if(isAttempted){
        setTimeout(()=>{ (isCorrect?correctSound:wrongSound).play(); }, 250);
      }
    }
  }

  function go(dir){
    const i = state.current + dir;
    if(i>=0 && i<quizData.questions.length){
      if(!state.submitted) updateTime();
      renderQuestion(i);
    }
  }

  function toggleMark() {
    state.markedForReview[state.current] = !state.markedForReview[state.current];
    renderQuestion(state.current); // Re-render to update button text
    updateTiles();
    updateStats();
  }

  function updateTime(){
    const now = new Date();
    state.timePerQ[state.current] += (now - state.startTime)/1000;
    state.startTime = now;
  }

  function updateStats() {
    const answeredCount = state.answers.filter(a => a !== null).length;
    const markedCount = state.markedForReview.filter(m => m).length;
    const totalCount = quizData.questions.length;
    document.getElementById('statAnswered').textContent = answeredCount;
    document.getElementById('statUnanswered').textContent = totalCount - answeredCount;
    document.getElementById('statMarked').textContent = markedCount;
    document.getElementById('statTotal').textContent = totalCount;
  }

  function updateProgress() {
      const answeredCount = state.answers.filter(a => a !== null).length;
      const totalCount = quizData.questions.length;
      const percent = totalCount > 0 ? (answeredCount / totalCount) * 100 : 0;
      const progressBar = document.getElementById('thinProgressBarInner');
      if (progressBar) {
          progressBar.style.width = `${percent}%`;
      }
  }

  // ----- Submit & Results -----
  function submitQuiz(){
    if(state.submitted) return;
    clearInterval(state.timerInterval);
    if(state.qTimerInterval) clearInterval(state.qTimerInterval); // Stop question timer

    updateTime();
    state.submitted=true;

    let correct=0, incorrect=0, unattempted=0, score=0, neg=0;
    state.answers.forEach((a,i)=>{
      if(a===null){ unattempted++; }
      else if(a===quizData.questions[i].correctIndex){ correct++; score+=1; }
      else { incorrect++; score-=state.negativeMark; neg+=state.negativeMark; }
    });

    state.avgTime = state.timePerQ.reduce((s,t)=>s+t,0)/quizData.questions.length;
    const pct = (score/quizData.questions.length)*100;

    questionArea.style.display = 'none';
    quizNav.style.display = 'none';
    submitBtn.style.display = 'none';
    document.querySelector('.quiz-main-header').style.display = 'none';

    renderResults({correct, incorrect, unattempted, score, neg, pct});
    resultsContainer.style.display = 'block';

    updateTiles();

    if(pct>=70){ confetti(); correctSound.play(); }
    else if(pct<50){ wrongSound.play(); }
  }

  function renderResults(resData) {
      const { correct, incorrect, unattempted, score, neg, pct } = resData;
      const total = quizData.questions.length;
      state.lastResultData = resData; // Save for redrawing charts on theme change

      let html = `
        <div class="results-container card-ui text-start">
            <div class="text-center">
                <h2 class="fw-bold">Quiz Completed!</h2>
                <p>Here is your performance summary.</p>
                <div class="final-score">${pct.toFixed(1)}%</div>
                <div class="fs-4 fw-bold mb-4">${score.toFixed(2)} / ${total}</div>
            </div>

            <ul class="nav nav-pills justify-content-center mb-3 results-tabs" id="pills-tab" role="tablist">
              <li class="nav-item" role="presentation"><button class="nav-link active" id="pills-summary-tab" data-bs-toggle="pill" data-bs-target="#pills-summary" type="button" role="tab">Summary</button></li>
              <li class="nav-item" role="presentation"><button class="nav-link" id="pills-analysis-tab" data-bs-toggle="pill" data-bs-target="#pills-analysis" type="button" role="tab">Analysis</button></li>
            </ul>

            <div class="tab-content" id="pills-tabContent">
              <div class="tab-pane fade show active" id="pills-summary" role="tabpanel">
                <div class="row g-3">
                    <div class="col-md-6"><div class="p-3 bg-light rounded d-flex justify-content-between"><span>Total Questions</span><span class="fw-bold">${total}</span></div></div>
                    <div class="col-md-6"><div class="p-3 bg-light rounded d-flex justify-content-between"><span>Correct</span><span class="fw-bold text-success">${correct}</span></div></div>
                    <div class="col-md-6"><div class="p-3 bg-light rounded d-flex justify-content-between"><span>Incorrect</span><span class="fw-bold text-danger">${incorrect}</span></div></div>
                    <div class="col-md-6"><div class="p-3 bg-light rounded d-flex justify-content-between"><span>Unattempted</span><span class="fw-bold text-warning">${unattempted}</span></div></div>
                    <div class="col-md-6"><div class="p-3 bg-light rounded d-flex justify-content-between"><span>Negative Marks</span><span class="fw-bold text-danger">-${neg.toFixed(2)}</span></div></div>
                </div>
              </div>
              <div class="tab-pane fade" id="pills-analysis" role="tabpanel">
                <div class="chart-container mb-3"><canvas id="performanceChart"></canvas></div>
                <div class="chart-container" style="height: 300px;"><canvas id="timeAnalysisChart"></canvas></div>

                <h5 class="fw-bold mt-5 mb-3 text-center">Telegram Leaderboard</h5>
                <div id="leaderboardSection"></div>
              </div>
            </div>
            <div class="text-center mt-4">
                <button id="reviewBtn" class="btn btn-primary btn-lg"><i class="fas fa-search me-2"></i>Review Answers</button>
            </div>
        </div>
      `;
      resultsContainer.innerHTML = html;

      document.getElementById('reviewBtn').addEventListener('click', reviewMode);

      // Render Leaderboard
      const lbSection = document.getElementById('leaderboardSection');
      if (quizData.leaderboard && quizData.leaderboard.rankings && quizData.leaderboard.rankings.length > 0) {
          let lbHtml = `<table class="leaderboard-table">
              <thead><tr><th>Rank</th><th>User</th><th>Score</th><th>Acc</th></tr></thead>
              <tbody>`;

          quizData.leaderboard.rankings.forEach((rank, i) => {
              const rankClass = i < 3 ? `rank-${i+1}` : '';
              lbHtml += `<tr>
                  <td class="${rankClass}">#${i+1}</td>
                  <td>${rank.name}</td>
                  <td>${rank.score.toFixed(1)}</td>
                  <td>${rank.accuracy.toFixed(0)}%</td>
              </tr>`;
          });

          lbHtml += `</tbody></table>`;
          lbSection.innerHTML = lbHtml;
      } else {
          lbSection.innerHTML = `<div class="text-muted small text-center p-3">No Telegram comparison data available yet.</div>`;
      }

      // Trigger chart build after tab is shown
      const analysisTab = document.getElementById('pills-analysis-tab');
      analysisTab.addEventListener('shown.bs.tab', () => buildCharts(resData), { once: true });
  }

  let performanceChartInstance, timeAnalysisChartInstance;
  function buildCharts(res){
    const {correct, incorrect, unattempted} = res;
    Chart.defaults.color = state.darkMode ? '#e8eaed' : '#6c757d';

    if (performanceChartInstance) performanceChartInstance.destroy();
    performanceChartInstance = new Chart(document.getElementById('performanceChart').getContext('2d'),{
      type:'doughnut',
      data:{ labels:['Correct','Incorrect','Unattempted'],
        datasets:[{ data:[correct,incorrect,unattempted],
          backgroundColor:['#20c997','#e63946','#ffb703'], borderWidth: 0 }]},
      options:{ responsive:true, maintainAspectRatio:false, plugins:{legend:{position:'bottom'}} }
    });

    const labels = Array.from({length:quizData.questions.length},(_,i)=>`Q${i+1}`);
    const correctTimes = state.timePerQ.map((t,i) => state.answers[i] === quizData.questions[i].correctIndex ? t : 0);
    const incorrectTimes = state.timePerQ.map((t,i) => (state.answers[i] !== null && state.answers[i] !== quizData.questions[i].correctIndex) ? t : 0);

    if(timeAnalysisChartInstance) timeAnalysisChartInstance.destroy();
    timeAnalysisChartInstance = new Chart(document.getElementById('timeAnalysisChart').getContext('2d'),{
      type:'bar',
      data:{ labels,
        datasets:[
          {label:'Correct', data:correctTimes, backgroundColor:'rgba(32, 201, 151, 0.7)'},
          {label:'Incorrect', data:incorrectTimes, backgroundColor:'rgba(230, 57, 70, 0.7)'}
        ]},
      options:{ responsive:true, maintainAspectRatio:false, indexAxis: 'x',
        scales:{ x:{stacked:true, grid: {color: state.darkMode ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)'}},
                 y:{stacked:true, title:{display:true,text:'Time (s)'}, grid: {color: state.darkMode ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)'}} },
      }
    });
  }

  function reviewMode(){
    state.inReviewMode=true; state.lastSoundIdx=-1;
    questionArea.style.display='block';
    quizNav.style.display = 'flex';
    resultsContainer.style.display='none';
    document.querySelector('.quiz-main-header').style.display = 'flex';
    renderQuestion(0);
  }

  function confetti(){
    const colors=['#6a5af9','#f72585','#20c997','#ffb703'];
    for(let i=0;i<100;i++){
      const d=document.createElement('div');
      d.style.cssText=`position:fixed;width:10px;height:10px;top:-10px;left:${Math.random()*100}vw;background:${colors[Math.floor(Math.random()*colors.length)]};z-index:1300;`;
      document.body.appendChild(d);
      const dy = Math.random()*500+500, rot = Math.random()*360;
      const anim = d.animate([{transform:'translateY(0) rotate(0)',opacity:1},{transform:`translateY(${dy}px) rotate(${rot}deg)`,opacity:0}],
        {duration:Math.random()*2000+2000, easing:'ease-out'});
      anim.onfinish=()=>d.remove();
    }
  }
})();
</script>
</body>
</html>
